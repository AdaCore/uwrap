template main {
    var title : text;
    var content : text;
}

match Entity () {
    match f_name ("A")
    weave self with main (title => "SELF TEMPLATE FOR A\n");

    match f_name ("A")
    weave with main (title => "IMPLICIT TEMPLATE FOR A\n");

    match p: parent (f_name ("A"))
    weave p with main (content => "'A' HAS A CHILD NAMED '\e<f_name>'\n");

    match parent (Entity () and p: parent (f_name ("A")))
    weave p with main (content => "'A' HAS A GRAND CHILD NAMED '\e<f_name>'\n");
}

match main ()
wrap with standard.out ("\e<title>{\n\e<self.content>}");
